<html><head>
  <script type="text/javascript" src="akihabara/gbox.js"></script>
  <script type="text/javascript" src="akihabara/iphopad.js"></script>
  <script type="text/javascript" src="akihabara/trigo.js"></script>
  <script type="text/javascript" src="akihabara/toys.js"></script>
  <script type="text/javascript" src="akihabara/help.js"></script>
  <script type="text/javascript" src="akihabara/tool.js"></script>
  <script type="text/javascript" src="akihabara/gamecycle.js"></script>
  <script type="text/javascript" src="lib/a_star.js"></script>
  <script type="text/javascript" src="lib/jquery-1.4.2.js"></script>
  <script type="text/javascript" src="lib/jquery.lowpro.js"></script>
  <script type="text/javascript" src="lib/screen.js"></script>
  <script type="text/javascript" src="lib/core/object.js"></script>
  <script type="text/javascript" src="lib/actors/basic_box.js"></script>
  <script type="text/javascript" src="lib/actors/celestial_body.js"></script>
  <script type="text/javascript" src="lib/mouse.js"></script>
  <script type="text/javascript" src="lib/planet.js"></script>
  <script type="text/javascript" src="lib/darrens_helpers.js"></script>
  <script type="text/javascript" src="lib/gbox_ext.js"></script>
  <script type="text/javascript" src="lib/sound.js"></script>
  <script type="text/javascript" src="parts/background.js"></script>
  
  <link rel="stylesheet" href="resources/style.css">
  <style>BODY { -webkit-user-select: none; margin: 0px }</style>
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
  <script>
var maingame;
var frameCount = 0;
var timeStarted;     // This will record the current time when the game started

window.addEventListener('load', loadResources, false);

function loadResources() {
  help.akihabaraInit({
    title:  '8by5',
    width:  1024,
    height: 768,
    zoom:   1
  });

  gbox.addBundle({ file: 'resources/bundle.js' });

  gbox.setAudioChannels({ bgmusic: { volume: 0.5 }, sfx: { volume: 1.0 }});

  gbox.loadAll(setup);
};

function setup() {
  gbox.setGroups(['mouse', 'background', 'bullets', 'player', 'planets', 'boxes', 'enemy', 'game']);

  maingame = gamecycle.createMaingame('game', 'game');

  maingame.gameMenu = function() { return true; };
  maingame.gameIntroAnimation = function() { return true; };
  maingame.gameTitleIntroAnimation = introScreenAnimation;
  maingame.initializeGame = function() {
    addBackground();

    addMouseControl();

    timeStarted = (new Date()).getTime();

    planetFactory.createPlanet({
      x: 100, y: 100,
      parentId: 'null',
      radius:   100,
      speed:    100,
      effect:   'playTrack',
      sound:    'moon_music_bells_1',
    });

    planetFactory.createPlanet({
      x: 300, y: 300,
      parentId: 'null',
      radius:   0,
      speed:    0,
      effect:   'playTrack',
      sound:    'moon_music_percussion_1'
    });

    planetFactory.createPlanet({
      x: 600, y: 100,
      parentId: 'null',
      radius:   0,
      speed:    0,
      effect:   'playTrack',
      sound:    'moon_music_bells_2'
    });

    planetFactory.createPlanet({
      parentId: 'planet-0',
      radius:   120,
      speed:    1,
      effect:   'fullVolume'
    });

    planetFactory.createPlanet({
      parentId: 'planet-1',
      radius:   80,
      speed:    3,
      effect:   'fullVolume'
    });

    planetFactory.createPlanet({
      parentId: 'planet-1',
      radius:   100,
      speed:    2,
      effect:   'fullVolume'
    });

    planetFactory.createPlanet({
      parentId: 'planet-1',
      radius:   120,
      speed:    5,
      effect:   'fullVolume'
    });

    planetFactory.createPlanet({
      parentId: 'planet-0-planet-0',
      radius:   20,
      speed:    6,
      effect:   'lowerHalfVolume'
    });

    playAll();
  };

  gbox.go();
}

function introScreenAnimation(reset) {
  // var introScreen = new IntroScreen();
  // introScreen.run();
  // if (reset) {
  //   toys.resetToy(this, 'rising');
  // }
  // 
  // gbox.blitFade(gbox.getBufferContext(), { alpha: 1 });
  // 
  // toys.logos.linear(this, 'rising', {
  //   image: 'logo',
  //   sx:    gbox.getScreenW()/2 - gbox.getImage('logo').width/2,
  //   sy:    gbox.getScreenH(),
  //   x:     gbox.getScreenW()/2 - gbox.getImage('logo').width/2,
  //   y:     20,
  //   speed: 1
  // });
};
</script>
</head><body></body></html>